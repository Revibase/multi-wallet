/**
 * This code was AUTOGENERATED using the Codama library.
 * Please DO NOT EDIT THIS FILE, instead use visitors
 * to add features, then rerun Codama to update it.
 *
 * @see https://github.com/codama-idl/codama
 */

import {
  combineCodec,
  getBooleanDecoder,
  getBooleanEncoder,
  getStructDecoder,
  getStructEncoder,
  getU8Decoder,
  getU8Encoder,
  type FixedSizeCodec,
  type FixedSizeDecoder,
  type FixedSizeEncoder,
} from 'gill';
import {
  getCompressionInfoDecoder,
  getCompressionInfoEncoder,
  type CompressionInfo,
  type CompressionInfoArgs,
} from '.';

/**
 * Compressible extension for token accounts.
 * This extension contains compression configuration and timing data.
 */
export type CompressibleExtension = {
  /** Option discriminator for decimals (0 = None, 1 = Some) */
  decimalsOption: number;
  /** Token decimals (only valid when decimals_option == 1) */
  decimals: number;
  /** Whether this account is compression-only (cannot decompress) */
  compressionOnly: boolean;
  /**
   * Whether the source account is an ATA (1 = ATA, 0 = regular account)
   * Used during compress_and_close to set is_ata in CompressedOnlyExtension
   */
  isAta: number;
  /** Compression configuration and timing data */
  info: CompressionInfo;
};

export type CompressibleExtensionArgs = {
  /** Option discriminator for decimals (0 = None, 1 = Some) */
  decimalsOption: number;
  /** Token decimals (only valid when decimals_option == 1) */
  decimals: number;
  /** Whether this account is compression-only (cannot decompress) */
  compressionOnly: boolean;
  /**
   * Whether the source account is an ATA (1 = ATA, 0 = regular account)
   * Used during compress_and_close to set is_ata in CompressedOnlyExtension
   */
  isAta: number;
  /** Compression configuration and timing data */
  info: CompressionInfoArgs;
};

export function getCompressibleExtensionEncoder(): FixedSizeEncoder<CompressibleExtensionArgs> {
  return getStructEncoder([
    ['decimalsOption', getU8Encoder()],
    ['decimals', getU8Encoder()],
    ['compressionOnly', getBooleanEncoder()],
    ['isAta', getU8Encoder()],
    ['info', getCompressionInfoEncoder()],
  ]);
}

export function getCompressibleExtensionDecoder(): FixedSizeDecoder<CompressibleExtension> {
  return getStructDecoder([
    ['decimalsOption', getU8Decoder()],
    ['decimals', getU8Decoder()],
    ['compressionOnly', getBooleanDecoder()],
    ['isAta', getU8Decoder()],
    ['info', getCompressionInfoDecoder()],
  ]);
}

export function getCompressibleExtensionCodec(): FixedSizeCodec<
  CompressibleExtensionArgs,
  CompressibleExtension
> {
  return combineCodec(
    getCompressibleExtensionEncoder(),
    getCompressibleExtensionDecoder()
  );
}
